<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>DeclarativeForms</TITLE>
<META content="text/html; charset=Windows-1252" http-equiv="Content-Type">
<META name="keywords" content="OneScript, DeclarativeForms, 1С">
<LINK rel="stylesheet" type="text/css" href="mainstyle.css">
</HEAD>
<BODY id=bodyID class=dtBODY>
<DIV id=nsbanner>
<DIV id=bannerrow1>
<TABLE class=bannerparthead cellSpacing=0>
  <TBODY>
  <TR id=hdr>
    <TD class=runninghead></TD>
    <TD class=product></TD></TR></TBODY></TABLE></DIV>
<DIV id=TitleRow>
<H1 class=dtH1>Библиотека DeclarativeForms</H1></DIV></DIV>
<DIV id=nstext>
<br>
<H3 class=dtH3>Назначение</H3>
<br>
<P>Декларативные формы задумывались как десктопное приложение на базе веб-технологий, со всеми возможностями движка Chrome. 
Изначально требования к приложению ставились следующие:</P>
<DIV style="margin-left: 40px;">
	<li>Нужна программа с браузером в окне, но не браузер с нашей программой.</li>
	<li>Нужен простой код создания и управления элементами и простая обработка событий. Что то вроде 
<PRE class=code>
Кнопка1 = ДФ.Кнопка();
Кнопка1.Родитель = Форма1;
Кнопка1.Текст = "Кнопка";
Кнопка1.Нажатие = ДФ.Действие(ЭтотОбъект, "Кнопка1_Нажатие");
</PRE>
	</li>
	<li>Запуск на любой платформе где можно запустить браузер Chrome.</li>
	<li>Избежать необходимости изучать дополнительные фреймворки.</li>
	<li>Приложение должно работать в фоне, запускаться при старте системы и оффлайн.</li>
	<li>Версия браузера определяется пользователем, а не системой.</li>
	<li>Возможность создания меню, нескольких окон, иконки в трее (менюбаре), управление ими.</li>
	<li>Возможность режима kiosk-mode (как в десктопных играх) и для создания презентаций в том числе.</li>
</DIV>
<P>В первую очередь это инструмент в помощь разработчикам на языке 1С. Используются два движка - 
<A href="https://oscript.io/" target="_blank">OneScript</A> и <A href="https://nwjs.io/" target="_blank">NW.JS</A>.</P>
<P><B>OneScript</B> повторяет синтаксис 1С, поэтому тем, кто с ним знаком дополнительно ничего изучать не нужно.</P>
<P><B>NW.JS</B> обеспечивает кроссплатформенность, так как может создать окно программы с браузером в этом окне. Его изучать не нужно, 
механизм его работы и взаимодействия со сценарием скрыт внутри библиотеки декларативных форм. <B>NW.JS</B> находится в активной разработке 
и часто выходят новые версии с обновленным движком <B>Chromium</B>. Вы сможете скачать <B>NW.JS</B> выбрав версию и платфому.</P>
<br>
<H3 class=dtH3>Требования к каталогу Вашей программы.</H3>
<br>
<P>Минимальные требования к устройству каталога Вашей программы при первом запуске показаны на рисунке ниже.</P>
<style>img { border: 3px solid #808080; }</style>
<IMG src="Intro1.jpg"></IMG>
<br>
<P><span style="color: #ff0000;"><B>Важно:</B> в каталоге <B>Классы</B> должна лежать библиотека TCP сервера <B>OneScriptClientServer.dll</B>.</span></P>
<P>Без TCP сервера невозможна связь формы с нашим сценарием. Я использовал версию <B>3.0.1.0</B> и она будет в релизе декларативных форм на гитхабе.</P>
<P>Имя стартового сценария не регламентируется. В этой справке стартовый сценарий будет называться <B>Главный.os</B>.</P>
<P>Содержимое файла <B>Главный.os</B> следующее:</P>
<PRE class=code>
ПодключитьВнешнююКомпоненту("C:\444\111\DeclarativeForms\DeclarativeForms\bin\Debug\DeclarativeForms.dll");
ДФ = Новый ДекларативныеФормы();
ДФ.nwПуть = "C:\222\nwjs\nw.exe";
ДФ.oscriptПуть = "C:\Program Files\OneScript\bin\oscript.exe";

Форма1 = ДФ.Форма;
Форма1.Открыть();
</PRE>
<P>Пути указаны с моего компьютера.</P>
<P>При запуске программа проверит наличие необходимых файлов и допишет их, с содержимым по умолчанию, в каталог. В итоге получится так:</P>
<style>img { border: 3px solid #808080; }</style>
<IMG src="Intro2.jpg"></IMG>
<P>Можно поместить движки <B>OneScript</B> и <B>NW.JS</B> в нашем каталоге и не указывать в сценарии пути до них. Программа по умолчанию будет искать их 
в каталогах <B>oscript</B> и <B>nwjs</B>. Код сценария сократится до:</P>
<PRE class=code>
ПодключитьВнешнююКомпоненту("C:\444\111\DeclarativeForms\DeclarativeForms\bin\Debug\DeclarativeForms.dll");
ДФ = Новый ДекларативныеФормы();

Форма1 = ДФ.Форма;
Форма1.Открыть();
</PRE>
<P>И каталог программы будет такой:</P>
<style>img { border: 3px solid #808080; }</style>
<IMG src="Intro3.jpg"></IMG>
<P></P>
<br>
<H3 class=dtH3>Конструкторы экземпляров класса.</H3>
<br>
<P>Создать элемент можно разными способами. Поддерживаются <B>HTML</B> тэги соответствующие элементу, но только для класса <B>Элемент</B>, так как он является базовым 
классом.</P>
<PRE class=code>
Кнопка1 = ДФ.Кнопка();
Кнопка2 = ДФ.Элемент("Кнопка");
Кнопка3 = ДФ.Элемент("button");
Абзац1 = ДФ.Элемент("p");
Диалог1 = ДФ.Элемент("dialog");
</PRE>
<P></P>
<br>
<H3 class=dtH3>Подключение библиотеки и создание объекта ДекларативныеФормы.</H3>
<br>
<P>Подключить библиотеку можно так:</P>
<PRE class=code>
ПодключитьВнешнююКомпоненту("ВашКаталогНаДиске\OneScriptDeclarativeForms.dll");
ДФ = Новый ДекларативныеФормы();
</PRE>
<P>При создании объекта ДекларативныеФормы автоматически выполнится метод <B>ДФ.ЗагрузитьСценарии(".\")</B> и подключатся сценарии находящиеся в 
подкаталогах <B>Классы</B> и <B>Модули</B>. В подключенных сценариях будет доступна структура под именем <B>ОбщаяСтруктура</B>. И у <B>ОбщаяСтруктура</B> 
будет свойство с именем <B>ДФ</B>. Так что Вы можете в подключенном сценарии сразу обратиться к объекту <B>ДекларативныеФормы</B> так:</P>
<PRE class=code>
Сообщить("из сценария ОбщаяСтруктура.ДФ = " + ОбщаяСтруктура.ДФ);
</PRE>
<br>
<H3 class=dtH3>Закрытие программы.</H3>
<br>
<P>После запуска стартового сценария откроется окно консоли и затем окно программы. Взаимодействовать они будут через запущенный фоновым заданием TCP сервер. 
Запуск TCP сервера производится файлом <B>startserver.os</B>. Файл сервера <B>server</B> не должен иметь расширения. Корректное закрытие всех запущенных 
модулей - это закрытие окна программы. Это вызовет завершение работы и <B>NW.JS</B>  и фонового TCP сервера и окна консоли.</P>
<P>Если закрыть только окно консоли это вызовет и завершение фонового TCP сервера, но окно программы останется открытым и может выдать сообщение о потере связи с сервером, 
после чего может автоматически закрыться. Возможно закрытия и не произойдет, зависит от кода программы. Следующий запуск стартового сценария будет успешным только 
после закрытия окна программы.</P>
<P>Избежать появление окна консоли совсем поможет разработка <A href="https://github.com/ahyahy/OneScriptNoConsole" target="_blank">Запуск сценариев OneScript без окна консоли</A>.</P>
<P></P>
<P></P>
<P></P>
<P></P>
<P></P>
<P></P>
<P></P>
<br>
<P>.</P>
</DIV></BODY></HTML>
